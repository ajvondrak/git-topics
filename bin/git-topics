#!/usr/bin/env bash

source "$(git --exec-path)/git-sh-setup"

usage() {
  echo >&2 "usage: git topics [<command>] [<options>]"
  echo >&2
  echo >&2 "See 'git help topics'."
  exit 1
}

lib() {
  local cwd="$PWD"
  local path="${BASH_SOURCE[0]}"

  while test -n "$path"; do
    cd "${path%/*}"
    path="$(readlink "${path##*/}" || true)"
  done

  cd ..
  echo "$(pwd)/lib/$1"
  cd "$cwd"
}

command="${1:-status}"
source="$(lib "$command")"

if test -f "$source"; then
  shift
  source "$source"
else
  echo >&2 "git-topics: '$command' is not a command."
  usage
fi
